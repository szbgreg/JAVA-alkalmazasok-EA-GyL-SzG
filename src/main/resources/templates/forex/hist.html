<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <title>FOREX Historikus Árfolyamok</title>
    <th:block layout:fragment="head"></th:block>
</head>
<body>
<div layout:fragment="content">

    <div class="container-fluid hero-header bg-light py-2 mb-5">
        <div class="container py-5">
            <div class="row g-5 align-items-center">
                <div class="col-lg-6">
                    <h1 class="display-5 mb-3 animated slideInDown">
                        Forex <span class="text-primary">Historikus Árfolyamok</span>
                    </h1>
                    <p class="text-secondary mb-2">
                        Válassz devizapárt és időintervallumot, majd tekintsd meg az utolsó 10 árfolyam adatot.
                    </p>
                </div>
                <div class="col-lg-6 text-center animated fadeIn">
                    <img class="img-fluid animated pulse infinite" style="animation-duration: 3s; max-height: 300px;"
                         src="/img/historic.png" alt="Historikus árfolyamok">
                </div>
            </div>
        </div>
    </div>

    <div class="container my-4 pb-5">
        <h3 class="mb-4 text-center">Historikus árfolyamok lekérdezése</h3>

        <form method="get" class="row g-3 align-items-end justify-content-center mb-4">
            <div class="col-md-4">
                <label class="form-label fw-bold text-secondary">Instrumentum</label>
                <select name="instrument" class="form-select shadow-sm">
                    <option th:each="i : ${instruments}" th:value="${i}"
                            th:selected="${i == instrument}" th:text="${i}">EUR_USD</option>
                </select>
            </div>

            <div class="col-md-4">
                <label class="form-label fw-bold text-secondary">Granularity</label>
                <select name="granularity" class="form-select shadow-sm">
                    <option th:each="g : ${granularities}" th:value="${g.name()}"
                            th:selected="${g == granularity}"
                            th:text="${g.name()} + ' - ' + ${g.label}"></option>
                </select>
            </div>

            <div class="col-md-2">
                <button class="btn btn-primary w-100" type="submit">
                    <i class="bi bi-search"></i> Lekérés
                </button>
            </div>
        </form>

        <div class="table-responsive" th:if="${#lists.size(candles) > 0}">
            <table class="table table-striped table-bordered shadow-sm align-middle">
                <thead class="table-primary text-center">
                <tr><th>Időpont</th><th>Záróár (Close)</th></tr>
                </thead>
                <tbody>
                <tr th:each="c : ${candles}">
                    <td th:text="${c.time}">2025-01-01 00:00</td>
                    <td th:text="${c.close}">1.0923</td>
                </tr>
                </tbody>
            </table>
        </div>

        <div th:if="${candleStr}" class="container mb-5">
            <div class="card bg-light border-0 p-4">
                <h5 class="text-secondary mb-3"><i class="bi bi-code-square me-1"></i> Lekérésre kapott válasz:</h5>
                <pre class="bg-body p-3 border rounded small text-dark" style="white-space: pre-wrap;" th:text="${candleStr}"></pre>
            </div>
        </div>

        <div class="alert alert-info mt-4 text-center shadow-sm" th:if="${#lists.size(candles) == 0}">
            Válassz devizapárt és granularitást, majd kattints a <strong>„Lekérés”</strong> gombra.
        </div>

    </div>

</div>
</body>
</html>
